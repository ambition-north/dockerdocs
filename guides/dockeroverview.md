# docker 概述

docker 是一个用于开发、发布、运行应用程序的开放平台。docker帮助你隔离你的应用和基础设施，因此你可以快速的迁移软件。用docker你可以像管理你的应用一样管理基础设施。充分使用docker发布，测试、部署代码的方法论，你看一显著减少写代码和在生产环境运行代码的延时。

## docker平台

docker提供了在宽松独立的环境打包和运行应用程序的能力，这个运行环境是容器。隔离行和安全性可以让你在一台主机上同时运行多个容器。容器是轻量的且包含了运行应用所需的所有依赖，因此，你不需要依赖主机上安装的内容。你可以在工作时分享容器并确保大家使用相同工作方式的容器。

docker提供了工具和平台去管理容器的生命周期：

- 使用容器开发应用程序及其支持的组建
- 容器成为分发和测试你的应用程序的单元
- 准备好后，将应用程序部署到生产环境，作为容器或编排服务

## 我能用docker做什么

### 快速一致性的交付你的应用程序

docker允许你使用支持应用和服务的本地容器在标准环境工作从而简化开发流程。容器非常适合持续集成和持续交付工作流。

思考下方的案例场景：

- 您的开发在本地写代码，使用容器与同事分享他的工作
- 他们使用docker将应用程序推送到测试环境并运行自动或者手动测试
- 当开发发现bugs，他们可以在开发环境修复问题并重新将代码部署到测试环境去测试验证
- 当完成测试，为客户提供解决方案像吧更新镜像推送到生产环境一样简单

### 响应部署和扩展

docker基于容器的平台允许高度可移植的工作负载。 docker容器可以在开发的本地电脑、数据中心的物理或者虚拟机器、在云提供商上、或者在混合环境运行

docker的可移植和轻量特性使动态管理工作负载更简单，可以近乎实时的根据业务需要决定扩展或者删除应用程序和服务

### 在相同的硬件上运行更高的负载

docker是轻量快速的。他为基于管理程序的虚拟机提供了可行的有效的替代方案，因此你可以使用更多的服务器容量去完成你的业务目标。docker适用于高密度环境和需要更少资源做更多事情的中小型部署场景

## docker 架构

docker使用客户端服务器架构。客户端与肩负构建、运行、分发容器重任的守护进程通信。客户端和守护进程可以运行在同一台机器，或者你可以用客户端去连接远程的守护进程。客户端和守护进程通信使用api接口、unix套接字或者网络接口、另一个docker客户端是让你与众多容器组成的应用工作的docker compose。
![alt text](image.png)

### docker守护进程

docker守护进程坚挺docker api的请求，管理docker对象如镜像、容器、网络、卷。一个守护进程还可以与其他守护进程通信来管理docker服务

### docker客户端

docker使用者用客户端与docker交互。当你使用docker命令行如docker run ， 客户端将命令行传送到守护进程，守护进程会执行他们。docker命令使用docker api，一个客户端可以与多个守护进程通信

### docker桌面

docker 桌面很容易安装在不同的操作系统上，让你去构建和分享容器化的应用程序和微服务。 docker 桌面包括docker守护进程（dockerd）、docker客户端（docker），docker compose， 镜像签名、容器编排系统和凭证帮助。了解更多信息查看文档[docker桌面](https://docs.docker.com/desktop/)

### docker注册表

docker注册表用于存储docker镜像。 docker hub是一个公共的注册表，所有人都可以使用，docker默认从docker hub搜索镜像。 你可以运行你的私有化注册表

当你执行docker pull或者docker run命令，docker 拉取需要的镜像从你配置的注册表。当你使用docker push命令，docker将镜像推送到你配置的注册表

### docker 对象

当你使用docker， 你会创建并使用镜像、容器、 网络、卷、 插件和其他对象。本节是一些对象的简单概述。

### 镜像

镜像是一个命令行只读模板用于创建docker 容器。 通常，一个镜像依赖其他镜像， 并带有一些额外的定义。例如，你可以构建一个基于ubuntu的镜像，还要安装apache web服务器和你的应用程序和你的程序运行需要的一些配置详情。

你可以使用自己创建的镜像或者是注册表中的别人发布的镜像。 创建你的个人镜像，用简单语法定义创建镜像的步骤和如何运行的dockerfile文件，dockerfile中的每一条指令都会在镜像中创建一层。当你改变dockerfile文件去重新构建docker镜像，只会构建变更的层级，这就是与其他虚拟技术相比较docker更加轻量、简单、快速。

### 容器

容器就是镜像的运行实例，你可以通过api或者命令行去创建、启动、暂停、转移或者删除容器。你可以将容器连接到一个或多个网络，将存储连接到它，甚至是用当前状态的容器创建一个新的镜像。

默认情况下，容器与其他容器或者主机是隔离的，你可以控制容器的网络、存储、或者其他底层子系统与其他容器或者主机的隔离程度。

当你去创建或者启动一个容器时，容器是由你的镜像和配置决定的，当容器被移除，他所有的没有存储到持久层的内容都会消息。

### docker run 命令

下方命令运行一个容器、绑定交互到你本地的命令行，并运行bash/bin命令



    docker run -i -t ubuntu /bin/bash


当你运行这个命令，下面的内容将会发生（假设你是用的默认配置registry）

1. 如果你本地没有ubuntu镜像，会从注册表拉取镜像到本地，就像本地手动执行docker pull ubuntu

2. docker创建一个新的容器，就像您手动运行docker container create 命令一样

3. docker分配读写文件系统给容器，作为容器的最后一层，支持在本地股文件系统中创建或者修改文件或者文件夹。

4. docker创建一个网络接口让容器连接到默认网络，如果你不指定网络配置项，将默认给容器分配一个id地址，容器可以通过主机的网络连接到外部网络。

5. docker启动容器并执行/bin/bash，因为docker以交互的方式运行并绑定了本地终端，你可以通过键盘输入内容并通过终端输出docker日志

6.  当你运行exit命令去终止bin/bash命令时，容器将会停止但不会被移除，你可以重启或者移除它。

### 底层技术

docker是用go程序语言开发的，充分利用linux内核特性去交付功能，利用命名空间技术去提供隔离的容器，当你运行一个容器，docker会创建一个命名空间集合。

命名空间提供了一个隔离层，容器的各个方面都运行在分割命名空间，他的访问权限被命名空间所限制。

### 下一步

#### 安装docker
#### 开启docker